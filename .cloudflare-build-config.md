# Cloudflare Pages 部署配置

## 项目信息
- **项目名称**: qwerty-learner
- **GitHub 仓库**: https://github.com/lansir2025/qwerty-learner
- **生产分支**: main (或 master)

## 构建配置

### 框架预设
- **Framework preset**: None (或选择 Vite)

### 构建设置
- **Build command**: `npm run build`
- **Build output directory**: `dist`
- **Root directory**: `/` (默认)

### 环境变量
- **Node version**: 20.19.6
- 添加环境变量: `NODE_VERSION=20.19.6`
- 添加环境变量: `NODE_OPTIONS=--max-old-space-size=4096`

## 部署步骤

### 方式1: 通过 Cloudflare Dashboard (推荐)

1. 访问 Cloudflare Dashboard: https://dash.cloudflare.com/
2. 点击左侧菜单 "Workers & Pages"
3. 点击 "Create application" 按钮
4. 选择 "Pages" 标签页
5. 点击 "Connect to Git"
6. 选择 GitHub 并授权 Cloudflare 访问
7. 选择仓库: `lansir2025/qwerty-learner`
8. 配置构建设置:
   - Project name: `qwerty-learner`
   - Production branch: `main` (或 `master`)
   - Build command: `npm run build`
   - Build output directory: `dist`
9. 在 "Environment variables" 部分添加:
   - `NODE_VERSION`: `20.19.6`
   - `NODE_OPTIONS`: `--max-old-space-size=4096`
10. 点击 "Save and Deploy"

### 方式2: 通过 Wrangler CLI

```bash
# 使用以下命令部署 (需要在沙箱中执行)
cd /home/user/webapp
source ~/.bashrc

# 方式 A: 直接部署 (推荐 - Cloudflare 会自动构建)
npx wrangler pages deploy dist --project-name=qwerty-learner --branch=main

# 方式 B: 连接到 Git 仓库 (需要交互)
# 这需要在 Cloudflare Dashboard 中手动配置 Git 连接
```

## 部署后访问

部署完成后，您的网站将可以通过以下 URL 访问:
- **Production**: https://qwerty-learner.pages.dev
- **Preview**: https://main.qwerty-learner.pages.dev (如果分支是 main)

## 故障排除

如果构建失败，尝试:
1. 确认 Node.js 版本设置正确 (20.x)
2. 增加内存限制: NODE_OPTIONS=--max-old-space-size=4096
3. 检查构建日志中的具体错误信息
4. 确认 package.json 中的 build 脚本正确

## 后续维护

- 每次推送到 main 分支，Cloudflare Pages 会自动重新部署
- 可以在 Cloudflare Dashboard 查看部署历史和日志
- 可以设置自定义域名
